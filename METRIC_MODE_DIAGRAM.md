# Info Sidebar Modes - Visual Guide

## Mode Decision Tree

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      INFO SIDEBAR MODES                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Is City Selected?  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                 â”‚
                â”Œâ”€â”€â”€â”˜                 â””â”€â”€â”€â”
               YES                        NO
                â”‚                          â”‚
                â–¼                          â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  CITY MODE   â”‚      â”‚ Is Metric Selected?  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚                 â”‚
                              â”Œâ”€â”€â”€â”˜                 â””â”€â”€â”€â”
                             YES                       NO
                              â”‚                         â”‚
                              â–¼                         â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  METRIC MODE   â”‚        â”‚  EMPTY MODE  â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Mode Comparison

### 1. EMPTY MODE (No City, No Metric)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“Š About                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Welcome text                               â”‚
â”‚ â€¢ Description of PedX Visualizer             â”‚
â”‚ â€¢ How to use instructions                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ”¥ Top Insights                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ðŸ‡²ðŸ‡¨ Monaco - Speed insight...            â”‚
â”‚ 2. ðŸ‡ºðŸ‡¸ New York - Behavior insight...       â”‚
â”‚ 3. ðŸ‡¯ðŸ‡µ Tokyo - Safety insight...            â”‚
â”‚ 4. ðŸ‡¦ðŸ‡º Sydney - Demographic insight...      â”‚
â”‚ 5. ðŸ‡©ðŸ‡ª Berlin - Infrastructure insight...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. METRIC MODE (No City, Metric Selected) â­ NEW
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš¡ Risky Crossing Rate                                  â”‚
â”‚ Percentage of pedestrians crossing in unsafe conditions â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ“Š Global: 18.5% | 47 cities                            â”‚
â”‚ ðŸ” Filters: Europe, Day, Male                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ“ˆ Top Cities                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ #1 ðŸ‡®ðŸ‡¹ Rome, Italy                                      â”‚
â”‚    â”—â” 24.3% â†‘ 31.4% vs global | 5 videos                â”‚
â”‚ #2 ðŸ‡ºðŸ‡¸ New York, USA                                    â”‚
â”‚    â”—â” 22.1% â†‘ 19.5% vs global | 8 videos                â”‚
â”‚ #3 ðŸ‡¯ðŸ‡µ Tokyo, Japan                                     â”‚
â”‚    â”—â” 21.5% â†‘ 16.2% vs global | 12 videos               â”‚
â”‚ ... (7 more cities)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ”— Key Relationships                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜ï¸ Rain + Night                    [â†‘ +12.3%]          â”‚
â”‚    Rain during night increases risky crossing by 12.3%  â”‚
â”‚                                                          â”‚
â”‚ ðŸ‘¤ Male                            [â†‘ +8.5%]           â”‚
â”‚    Male pedestrians show 8.5% higher risky crossing     â”‚
â”‚                                                          â”‚
â”‚ ðŸš— Bus                             [â†‘ +7.2%]           â”‚
â”‚    Presence of buses increases risk by 7.2%             â”‚
â”‚ ... (3 more relationships)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ’¡ Key Insights                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Rome leads with 24.3%, significantly above the        â”‚
â”‚   global average                                         â”‚
â”‚ â€¢ Rain during night increases risky crossing by 12.3%   â”‚
â”‚ â€¢ Data from 247 videos across 47 cities, analyzing      â”‚
â”‚   15,234 pedestrian crossings                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸŒ All Cities (47)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ # â”‚ City      â”‚ Country â”‚ Value   â”‚ Î” Global â”‚ Videos  â”‚
â”‚â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ 1 â”‚ Rome      â”‚ Italy   â”‚ 24.3%   â”‚ +31.4%   â”‚ 5       â”‚
â”‚ 2 â”‚ New York  â”‚ USA     â”‚ 22.1%   â”‚ +19.5%   â”‚ 8       â”‚
â”‚ 3 â”‚ Tokyo     â”‚ Japan   â”‚ 21.5%   â”‚ +16.2%   â”‚ 12      â”‚
â”‚ 4 â”‚ Paris     â”‚ France  â”‚ 20.8%   â”‚ +12.4%   â”‚ 6       â”‚
â”‚ ... (43 more rows, scrollable)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. CITY MODE (City Selected)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ‡ºðŸ‡¸ New York                                 â”‚
â”‚ United States | North America                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Population: 8,336,817                        â”‚
â”‚ Location: 40.7128, -74.0060                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ“Š KPI Strip                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš¡ Crossing Speed: 1.86 m/s (+12% vs global)â”‚
â”‚ â±ï¸ Time to Start: 2.3s (-8% vs global)      â”‚
â”‚ âš ï¸ Risky Crossing: 18.5% (-5% vs global)    â”‚
â”‚ ðŸš¦ Red Light Rate: 15.2% (+15% vs global)   â”‚
â”‚ ðŸ›¡ï¸ Crosswalk Usage: 85.3% (+8% vs global)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ’¡ Key Insights                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ High compliance with crosswalk usage       â”‚
â”‚ â€¢ Above-average red light violations        â”‚
â”‚ â€¢ Fast crossing speeds indicate confidence  â”‚
â”‚ â€¢ Younger demographic (avg 32 years)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ðŸ“Š Rankings                                  â”‚
â”‚ ðŸ“ˆ Environment                               â”‚
â”‚ ðŸ‘¥ Demographics                              â”‚
â”‚ ðŸš— Vehicles                                  â”‚
â”‚ ðŸŽ¥ Videos Analyzed (8 videos)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## User Interaction Flows

### Flow 1: Exploring a Metric
```
1. User clicks "Search by behaviour..." 
   â””â”€> Filter sidebar opens behavior dropdown
2. User selects "Risky Crossing Rate"
   â””â”€> Info sidebar switches to METRIC MODE
3. User sees:
   - Top cities ranked by risky crossing rate
   - Correlations with weather, demographics, vehicles
   - All cities table with rankings
4. User clicks on "Rome" in top cities list
   â””â”€> Info sidebar switches to CITY MODE for Rome
```

### Flow 2: Comparing Cities by Metric
```
1. User in EMPTY MODE
2. User selects "Crosswalk Usage Rate" from behavior search
   â””â”€> Info sidebar shows METRIC MODE
3. User scrolls through "All Cities" table
4. User compares values:
   - Monaco: 92.3% (+8.2% vs global)
   - Tokyo: 88.7% (+4.1% vs global)
   - New York: 85.3% (+0.1% vs global)
5. User clicks on Monaco
   â””â”€> Info sidebar switches to CITY MODE for Monaco
```

### Flow 3: Discovering Relationships
```
1. User selects "Run Red Light Rate" metric
   â””â”€> Info sidebar shows METRIC MODE
2. User views "Key Relationships" section:
   - "Night" â†’ â†‘ +15.3% red light violations
   - "Rain + Night" â†’ â†‘ +23.8% red light violations
   - "Male" â†’ â†‘ +12.1% red light violations
3. User applies filters:
   - Weather: Rain
   - Time: Night
4. Top cities list updates to show cities with highest
   rain + night red light violations
```

## Interactive Elements

### Clickable Elements in METRIC MODE

1. **City in Top Cities List**
   - Click â†’ Pin city and switch to CITY MODE
   
2. **City in All Cities Table**
   - Click row â†’ Pin city and switch to CITY MODE
   
3. **Filter Chips in Header**
   - Display active filters (read-only, managed from left sidebar)

4. **Scroll Areas**
   - Top Cities: Scrollable list (max height 300px)
   - All Cities Table: Scrollable table (max height 400px)

## Data Update Triggers

```
Metric Mode updates when:
â”œâ”€ selectedMetrics changes
â”œâ”€ granularFilters change (future enhancement)
â””â”€ Database refreshes (manual refresh button)

API Calls Made:
â”œâ”€ GET /api/metrics/[metric]
â”‚   â””â”€ Returns: metric info, global stats, all cities ranked
â””â”€ GET /api/metrics/[metric]/relationships
    â””â”€ Returns: correlations with environmental/demographic factors
```

## Color Coding System

```
ðŸŸ¢ Green (â†“)  = Below global (good for negative metrics)
ðŸ”´ Red (â†‘)    = Above global (bad for negative metrics)
ðŸ”µ Blue       = Metric-related UI elements
âšª Muted      = Secondary information
```

## Responsive Behavior

- **Desktop (>1024px)**: Full layout with all sections visible
- **Tablet (768-1024px)**: Scrollable sections, compact spacing
- **Mobile (<768px)**: Sidebar collapses, reopens on demand

## Accessibility Features

- âœ… Semantic HTML (table, thead, tbody)
- âœ… ARIA labels for interactive elements
- âœ… Keyboard navigation support
- âœ… Screen reader friendly
- âœ… Color + icon indicators (not color alone)
- âœ… High contrast mode compatible

## Performance Characteristics

- **Initial Load**: ~200ms (from materialized views)
- **Metric Switch**: ~150ms (API call + render)
- **City Pin**: Instant (data already in context)
- **Filter Apply**: ~100ms (frontend filtering)

## Future Enhancement Ideas

1. **Charts**: Add distribution histograms for metrics
2. **Comparison**: Multi-metric comparison view
3. **Export**: Download rankings as CSV/PDF
4. **Filters**: Apply granular filters to rankings
5. **Bookmarks**: Save favorite metric + filter combinations

